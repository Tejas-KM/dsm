<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Distance Measurement App</title>
    <meta name="description" content="Professional distance measurement app using WebXR AR and camera-based triangle similarity">
    <link rel="stylesheet" href="styles/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="app-header">
            <h1>üìè Distance Meter</h1>
            <div class="header-controls">
                <select id="unitSelector" class="form-control unit-selector">
                    <option value="mm">mm</option>
                    <option value="cm">cm</option>
                    <option value="m" selected>meters</option>
                    <option value="in">inches</option>
                    <option value="ft">feet</option>
                </select>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Mode Selection Screen -->
            <div id="modeSelection" class="mode-selection">
                <div class="app-intro">
                    <h2>üìê Measure Real-World Objects</h2>
                    <p>Choose your measurement method based on your device capabilities</p>
                </div>
                
                <div class="capability-info">
                    <div id="webxrStatus" class="capability-status">
                        <span class="status-indicator"></span>
                        <span class="status-text">Checking WebXR support...</span>
                    </div>
                </div>
                
                <div class="mode-buttons">
                    <button id="arModeBtn" class="mode-btn ar-mode" disabled>
                        <div class="mode-icon">ü•Ω</div>
                        <div class="mode-title">AR Mode</div>
                        <div class="mode-description">High accuracy using device AR capabilities</div>
                        <div class="mode-features">
                            <span class="feature">‚úì Sub-centimeter accuracy</span>
                            <span class="feature">‚úì 3D surface detection</span>
                            <span class="feature">‚úì Multiple point measurement</span>
                        </div>
                    </button>
                    
                    <button id="cameraModeBtn" class="mode-btn camera-mode">
                        <div class="mode-icon">üì∑</div>
                        <div class="mode-title">Camera Mode</div>
                        <div class="mode-description">Works on all devices with camera</div>
                        <div class="mode-features">
                            <span class="feature">‚úì Universal compatibility</span>
                            <span class="feature">‚úì Reference object calibration</span>
                            <span class="feature">‚úì Good accuracy</span>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Camera View Container -->
            <div id="cameraContainer" class="camera-container hidden">
                <video id="cameraVideo" class="camera-video hidden" autoplay muted playsinline></video>
                <canvas id="measurementCanvas" class="measurement-canvas hidden"></canvas>
                <div id="arContainer" class="ar-container hidden"></div>
                
                <!-- Camera Overlay UI -->
                <div class="camera-overlay">
                    <div class="measurement-info">
                        <div id="currentDistance" class="current-distance hidden">
                            <span class="distance-value">0.00</span>
                            <span class="distance-unit">m</span>
                        </div>
                        <div id="accuracyIndicator" class="accuracy-indicator hidden">
                            <span class="accuracy-text">Accuracy: Medium</span>
                        </div>
                        <div id="instructionsText" class="instructions-text hidden">
                            Point your camera at objects and start measuring
                        </div>
                    </div>
                    
                    <!-- AR Mode Controls -->
                    <div id="arControls" class="ar-controls hidden">
                        <div class="ar-reticle"></div>
                        <div class="ar-instructions">Move your device to detect surfaces</div>
                    </div>
                    
                    <div class="camera-controls">
                        <button id="measureBtn" class="control-btn measure-btn">
                            <span class="btn-icon">üìê</span>
                            <span class="btn-text">Start Measuring</span>
                        </button>
                        <button id="clearBtn" class="control-btn clear-btn hidden">
                            <span class="btn-icon">üóëÔ∏è</span>
                            <span class="btn-text">Clear</span>
                        </button>
                        <button id="backBtn" class="control-btn back-btn">
                            <span class="btn-icon">‚¨ÖÔ∏è</span>
                            <span class="btn-text">Back</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Calibration Modal -->
            <div id="calibrationModal" class="modal hidden">
                <div class="modal-content">
                    <h3>üìè Camera Calibration Required</h3>
                    <p>To measure accurately, we need to calibrate using a reference object of known size.</p>
                    
                    <div class="reference-objects">
                        <label for="referenceSelect">Choose your reference object:</label>
                        <select id="referenceSelect" class="reference-select">
                            <option value="credit_card">Credit Card (85.6mm √ó 53.98mm)</option>
                            <option value="quarter">US Quarter (24.26mm diameter)</option>
                            <option value="iphone">iPhone Standard (67.3mm wide)</option>
                            <option value="a4_paper">A4 Paper (210mm √ó 297mm)</option>
                            <option value="business_card">Business Card (89mm √ó 51mm)</option>
                        </select>
                    </div>
                    
                    <div class="calibration-instructions">
                        <h4>Calibration Steps:</h4>
                        <ol>
                            <li>Place the selected object clearly in the camera view</li>
                            <li>Ensure good lighting and the object is flat</li>
                            <li>Click on both ends of the object's width</li>
                            <li>The app will calculate the scale factor</li>
                        </ol>
                        <div class="tip">
                            <strong>üí° Tip:</strong> Credit cards provide the most accurate calibration
                        </div>
                    </div>
                    
                    <div class="modal-actions">
                        <button id="startCalibrationBtn" class="btn-primary">
                            <span>üéØ Start Calibration</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Results Display Panel -->
            <div id="resultsPanel" class="results-panel hidden">
                <div class="results-header">
                    <h3>üìä Measurement Results</h3>
                    <div class="results-summary">
                        <span id="measurementCount">0 measurements</span>
                    </div>
                </div>
                
                <div id="measurementsList" class="measurements-list">
                    <!-- Measurements will be populated here -->
                </div>
                
                <div class="results-actions">
                    <button id="exportBtn" class="btn-secondary">
                        <span class="btn-icon">üì§</span>
                        <span class="btn-text">Export Data</span>
                    </button>
                    <button id="newMeasurementBtn" class="btn-primary">
                        <span class="btn-icon">üÜï</span>
                        <span class="btn-text">New Measurement</span>
                    </button>
                </div>
            </div>

            <!-- Help Modal -->
            <div id="helpModal" class="modal hidden">
                <div class="modal-content">
                    <h3>‚ùì How to Use</h3>
                    <div class="help-content">
                        <div class="help-section">
                            <h4>ü•Ω AR Mode (Android Chrome)</h4>
                            <ul>
                                <li>Move your device to detect surfaces</li>
                                <li>Tap to place measurement points</li>
                                <li>Measure between multiple points</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>üì∑ Camera Mode (All Devices)</h4>
                            <ul>
                                <li>Calibrate with a reference object first</li>
                                <li>Click two points to measure distance</li>
                                <li>Ensure good lighting and steady hands</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>üéØ Best Practices</h4>
                            <ul>
                                <li>Use rear camera for better accuracy</li>
                                <li>Hold device steady while measuring</li>
                                <li>Measure objects at eye level when possible</li>
                                <li>Re-calibrate if measurements seem off</li>
                            </ul>
                        </div>
                    </div>
                    <button id="closeHelpBtn" class="btn-primary">Got it!</button>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="app-footer hidden">
            <div class="footer-content">
                <button id="helpBtn" class="footer-btn">‚ùì Help</button>
                <div class="footer-info">
                    <span>Distance Measurement App v1.0</span>
                </div>
            </div>
        </footer>
    </div>

    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-icon">üìè</div>
            <h2>Distance Meter</h2>
            <div class="loading-spinner"></div>
            <p>Initializing camera and AR capabilities...</p>
        </div>
    </div>

    <script src="scripts/app.js"></script>
</body>
</html>